<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicine List</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='medicine_list.css') }}">
    <script>
        function updateQuantity(medicineId, action) {
            fetch(`/update_quantity/${medicineId}/${action}`, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById(`quantity-${medicineId}`).textContent = data.new_quantity;
                } else {
                    alert('Failed to update quantity');
                }
            });
        }
    </script>
</head>
<body>
    <h1>Medicines Available at {{ pharmacy_name }}</h1>
    <table>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Actions</th>
        </tr>
        {% for medicine in medicines %}
        <tr>
            <td>{{ medicine[1] }}</td>
            <td>{{ medicine[4] }}</td>
            <td>{{ medicine[3] }}</td>
            <td id="quantity-{{ medicine[0] }}">{{ medicine[2] }}</td>
            <td>
                <button onclick="updateQuantity({{ medicine[0] }}, 'decrement')">+</button>
                <button onclick="updateQuantity({{ medicine[0] }}, 'increment')">-</button>
            </td>
        </tr>
        {% endfor %}
    </table>
    <button onclick="window.location.href='/checkout/{{ pharmacy_id }}'">Checkout</button>
</body>
</html>

<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicine List</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='medicine_list.css') }}">
    <script>
        function updateQuantity(medicineId, action) {
            fetch(`/update_quantity/${medicineId}/${action}`, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById(`quantity-${medicineId}`).textContent = data.new_quantity;
                } else {
                    alert('Failed to update quantity');
                }
            });
        }
    </script>
</head>
<body>
    <h1>Medicines Available at {{ pharmacy_name }}</h1>
    <table>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Actions</th>
        </tr>
        {% for medicine in medicines %}
        <tr>
            <td>{{ medicine[1] }}</td>
            <td>{{ medicine[4] }}</td>
            <td>{{ medicine[3] }}</td>
            <td id="quantity-{{ medicine[0] }}">{{ medicine[2] }}</td>
            <td>
                <button onclick="updateQuantity({{ medicine[0] }}, 'increment')">+</button>
                <button onclick="updateQuantity({{ medicine[0] }}, 'decrement')">-</button>
            </td>
        </tr>
        {% endfor %}
    </table>
    <button onclick="window.location.href='/checkout/{{ pharmacy_id }}'">Checkout</button>
</body>
</html> --> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicine List</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='medicine_list.css') }}">
    <script>
        function updateQuantity(medicineId, action) {
            fetch(`/update_quantity/${medicineId}/${action}`, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById(`quantity-${medicineId}`).textContent = data.new_quantity;
                    calculateBill();
                } else {
                    alert('Failed to update quantity');
                }
            });
        }

        function calculateBill() {
            fetch('/calculate_bill')
            .then(response => response.json())
            .then(data => {
                document.getElementById('total_bill').textContent = `Total Bill: $${data.total_bill.toFixed(2)}`;
                let purchasedItems = '';
                data.purchased_items.forEach(item => {
                    purchasedItems += `<li>${item[0]}: ${item[1]} x $${item[2]}</li>`;
                });
                document.getElementById('purchased_items').innerHTML = purchasedItems;
            });
        }
    </script>
</head>
<body>
    <h1>Medicines Available at {{ pharmacy_name }}</h1>
    <table>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Actions</th>
        </tr>
        {% for medicine in medicines %}
        <tr>
            <td>{{ medicine[1] }}</td>
            <td>{{ medicine[4] }}</td>
            <td>{{ medicine[3] }}</td>
            <td id="quantity-{{ medicine[0] }}">{{ medicine[2] }}</td>
            <td>
                <button onclick="updateQuantity({{ medicine[0] }}, 'decrement')">+</button>
                <button onclick="updateQuantity({{ medicine[0] }}, 'increment')">-</button>
            </td>
        </tr>
        {% endfor %}
    </table>
    <h2 id="total_bill">Total Bill: $0.00</h2>
    <ul id="purchased_items"></ul>
    <button onclick="window.location.href='/checkout/{{ pharmacy_id }}'">Checkout</button>
</body>
</html>
